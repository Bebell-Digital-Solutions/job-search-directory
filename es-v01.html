<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Directorio de B칰squeda de Empleo</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the app. The primary color is #df1783 */
         /* Replace your current :root styles with these */
    :root {
        --primary: #DF1783;
        --primary-light: #f8a4d4;
        --secondary: #2d3748;
        --accent: #4fd1c5;
        --text: #2d3748;
        --text-light: #f7fafc;
        --bg: #f7fafc;
        --card-bg: #ffffff;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --border-color: #e2e8f0;
    }

    /* Updated from .dark-mode to .dark to match Tailwind's convention and the JS implementation */
    .dark {
        --primary: #DF1783;
        --primary-light: #4a1a38;
        --secondary: #1e2837;
        --accent: #4fd1c5;
        --text: #f7fafc;
        --text-light: #2d3748;
        --bg: #1a202c;
        --card-bg: #2d3748;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.1);
        --border-color: #4a5568;
    }
    
      body {
        background-color: var(--bg);
        color: var(--text);
    }
  
        .text-primary {
            color: var(--primary);
        }
        
        .bg-primary {
            background-color: var(--primary);
        }
        
        .border-primary {
            border-color: var(--primary);
        }
        
        .hover-bg-primary:hover {
            background-color: var(--primary-light);
        }
        
        .job-card {
            background-color: var(--card-bg);
            border-color: var(--border-color);
            box-shadow: var(--shadow);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }
        
        .job-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .list-view-card {
            display: grid;
            grid-template-columns: 1fr;
        }
        
        @media (min-width: 768px) {
            .list-view-card {
                grid-template-columns: 2fr 3fr 1fr;
            }
        }
        .list-view .job-card-grid-content {
            display: none;
        }
        .grid-view .job-card-list-content {
            display: none;
        }
        /* Style for the scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .dark ::-webkit-scrollbar-track {
            background: #2d3748;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #4a5568;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
        /* Collapsible content animation */
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .collapsible-content.expanded {
            max-height: 1000px; /* A large value to allow for expansion */
            transition: max-height 0.5s ease-in;
        }
    </style>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="font-sans antialiased min-h-screen flex flex-col transition-colors duration-300">

    <!-- Theme Toggle Floating Button -->
    <button id="theme-toggle" class="fixed top-4 left-4 p-3 bg-white dark:bg-gray-800 rounded-full shadow-lg z-50 transition-transform transform hover:scale-110 focus:outline-none">
        <i data-lucide="moon" class="w-6 h-6 text-gray-800 dark:hidden"></i>
        <i data-lucide="sun" class="w-6 h-6 text-yellow-400 hidden dark:block"></i>
    </button>

    <!-- Main Content Container -->
    <div class="container mx-auto p-4 md:p-8 flex-grow">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-5xl font-bold text-gray-900 dark:text-gray-100 mb-2">游댍 Directorio de B칰squeda de Empleo</h1>
            <p class="text-lg md:text-xl text-gray-600 dark:text-gray-400">Encuentra las mejores fuentes de trabajo remoto y freelance de la web.</p>
        </header>

        <!-- Search, View Controls, and Add button -->
        <div class="flex flex-col md:flex-row items-center justify-center md:justify-between mb-8 space-y-4 md:space-y-0">
            <!-- Search Bar Container -->
            <div class="relative w-full md:w-2/3 mx-auto">
                <input type="text" id="search-bar" placeholder="Buscar por sitio web, etiqueta o descripci칩n..." class="w-full pl-10 pr-4 py-3 rounded-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-300">
                <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-gray-500"></i>
            </div>
            <!-- View Buttons -->
            <div class="flex items-center space-x-2 md:mt-0">
                <button id="grid-view-btn" class="p-2 rounded-full bg-primary text-white shadow-md focus:outline-none hover-bg-primary transition-all duration-300">
                    <i data-lucide="layout-grid" class="w-6 h-6"></i>
                </button>
                <button id="list-view-btn" class="p-2 rounded-full bg-gray-300 dark:bg-gray-600 text-gray-600 dark:text-gray-300 shadow-md focus:outline-none hover:bg-gray-400 dark:hover:bg-gray-500 transition-all duration-300">
                    <i data-lucide="list" class="w-6 h-6"></i>
                </button>
            </div>
        </div>

        <!-- Filter Tags -->
        <div id="tag-container" class="flex flex-wrap gap-2 justify-center mb-8">
            <!-- Tags will be dynamically populated here -->
        </div>

        <!-- Job Listings Container -->
        <div id="job-listings-container" class="grid-view grid gap-6 transition-all duration-300">
            <!-- Job cards will be dynamically populated here -->
        </div>

    </div>

    <!-- Floating Add New Button -->
    <button id="add-new-btn" class="fixed bottom-8 right-8 p-4 bg-primary text-white rounded-full shadow-lg z-50 transition-transform transform hover:scale-110 focus:outline-none">
        <i data-lucide="plus" class="w-8 h-8"></i>
    </button>

    <!-- Modal for adding new data -->
    <div id="add-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 z-50 flex items-center justify-center hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8 w-11/12 md:w-2/3 lg:w-1/2 max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300">
            <div class="flex justify-between items-center mb-4">
                <h2 id="modal-title" class="text-2xl font-bold text-gray-900 dark:text-gray-100">Acceso de Administrador</h2>
                <button id="modal-close-btn" class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>

            <!-- Login Form -->
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="username" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Nombre de Usuario</label>
                    <input type="text" id="username" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                </div>
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Contrase침a</label>
                    <input type="password" id="password" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                </div>
                <button type="submit" class="w-full py-2 px-4 rounded-md text-white bg-primary hover-bg-primary focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300">Iniciar Sesi칩n</button>
                <p id="login-message" class="text-center text-sm font-medium"></p>
            </form>



          

            <!-- Data Entry Form (hidden by default) -->
            <div id="data-entry-container" class="hidden">
                <form id="add-data-form" class="space-y-4">
                    <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">Agrega una Nueva Fuente de B칰squeda:游녢</h3>
                    <div>
                        <label for="website" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Sitio Web</label>
                        <input type="text" id="website" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                    </div>
                    <div>
                        <label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Descripci칩n</label>
                        <textarea id="description" rows="3" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required></textarea>
                    </div>
                    <div>
                        <label for="remote-jobs" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Trabajos Remotos</label>
                        <input type="text" id="remote-jobs" placeholder="S칤/No/N/A" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                    </div>
                    <div>
                        <label for="target-audience" class="block text-sm font-medium text-gray-700 dark:text-gray-300">P칰blico Objetivo</label>
                        <input type="text" id="target-audience" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                    </div>
                    <div>
                        <label for="qualifications" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Requisitos</label>
                        <input type="text" id="qualifications" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                    </div>
                    <div>
                        <label for="url" class="block text-sm font-medium text-gray-700 dark:text-gray-300">URL</label>
                        <input type="url" id="url" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                    </div>
                    <div>
                        <label for="reliability-indicators" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Indicadores de Confianza</label>
                        <textarea id="reliability-indicators" rows="2" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"></textarea>
                    </div>
                    <div>
                        <label for="potential-risks" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Riesgos Potenciales</label>
                        <textarea id="potential-risks" rows="2" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"></textarea>
                    </div>
                    <div>
                        <label for="how-to-get-paid" class="block text-sm font-medium text-gray-700 dark:text-gray-300">C칩mo Recibir Pagos</label>
                        <textarea id="how-to-get-paid" rows="2" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"></textarea>
                    </div>
                    <div>
                        <label for="application-requirements" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Requisitos de Aplicaci칩n</label>
                        <textarea id="application-requirements" rows="2" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"></textarea>
                    </div>
                    <div class="flex items-center pt-2">
                        <input type="checkbox" id="is-recommended" class="h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary">
                        <label for="is-recommended" class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Marcar como Recomendado</label>
                    </div>
                    <div>
                        <label for="new-tags" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Asigna Etiquetas:</label>
                        <div id="selected-tags-container" class="flex flex-wrap gap-2 mt-1 mb-2"></div>
                        <input type="text" id="new-tags" placeholder="A침adir nuevas etiquetas, separadas por comas" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mt-2">O selecciona etiquetas existentes:</label>
                        <div id="existing-tags-container" class="flex flex-wrap gap-2 mt-1 max-h-24 overflow-y-auto p-2 border border-gray-300 dark:border-gray-600 rounded-md">
                            <!-- Existing tags will be populated here by JS -->
                        </div>
                    </div>
                    <button type="submit" class="w-full py-2 px-4 rounded-md text-white bg-primary hover-bg-primary focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300">A침adir Entrada</button>
                </form>





              

                <div class="my-6 text-center text-gray-500 dark:text-gray-400">
                    <p>o</p>
                </div>

                <div class="space-y-4">
                    <h3 class="text-xl font-bold text-gray-900 dark:text-gray-100">Carga Masiva (CSV)</h3>
                    <div>
                        <label for="csv-upload" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Subir Archivo CSV</label>
                        <input type="file" id="csv-upload" accept=".csv" class="mt-1 block w-full text-gray-900 dark:text-gray-100 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary/80 transition-all duration-200">
                    </div>
                    <button id="upload-csv-btn" class="w-full py-2 px-4 rounded-md text-white bg-primary hover-bg-primary focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300">Subir CSV</button>
                </div>
            </div>
        </div>
    </div>








  
    
    <script>
        // Datos de la solicitud del usuario (traducidos al espa침ol)
        const comprehensiveJobSources = {
            'Website': [
                'Virtual Latinos', 'Remote Latinos', 'Freelance Latin America', 'South (HireInSouth)', 'HireLATAM',
                'Working Nomads', 'Remote.co', 'We Work Remotely', 'RemoteOK', 'FlexJobs', 'Upwork', 'Fiverr',
                'Workana', 'Get on Board', 'Dynamite Jobs', 'Toptal', 'Guru', '99designs', 'PeoplePerHour',
                'Freelancer.com', 'AngelList', 'Indeed', 'Pros Marketplace', 'Somewhere', 'TaskRabbit',
                'Contra', 'Gun.io', 'Payoneer', 'Wise', 'Remote Rocketship'
            ],
            'Description': [
                'Plataforma de reclutamiento que conecta empresas de EE. UU./Canad치 con asistentes virtuales biling칲es de Am칠rica Latina.',
                'Mercado de talento de 칠lite que conecta empresas con los mejores profesionales de Am칠rica Latina con un ahorro de costos del 80%.',
                'Agencia de personal remoto totalmente gestionada que proporciona talento biling칲e con educaci칩n universitaria de LATAM.',
                'Plataforma que ayuda a las empresas a encontrar, contratar y pagar a los mejores talentos de Am칠rica Latina con un proceso de contrataci칩n de 21 d칤as.',
                'Facilita las conexiones entre empresas de EE. UU. y profesionales remotos preseleccionados en diversos campos.',
                'Bolsa de trabajo remota global con listados espec칤ficos de Am칠rica Latina y roles basados en lo digital.',
                'Plataforma de listados de trabajos remotos curados que se enfoca en oportunidades remotas leg칤timas en todo el mundo.',
                'Gran bolsa de trabajo remota que conecta talento con empresas que priorizan el trabajo remoto a nivel mundial.',
                'Agregador de trabajos remotos en tiempo real con listados globales que incluyen posiciones en Am칠rica Latina.',
                'Bolsa de trabajo premium basada en suscripci칩n que se especializa en oportunidades de trabajo flexible y remoto.',
                'Mercado global de freelancers con trabajo por proyecto y por hora en todas las categor칤as.',
                'Mercado basado en "gigs" que ofrece servicios a precio fijo desde $5 en campos creativos.',
                'Mercado de freelancers enfocado en Am칠rica Latina para profesionales de habla hispana/portuguesa.',
                'Comunidad de empleos de tecnolog칤a y startups curada que sirve principalmente a los mercados de Am칠rica Latina.',
                'Plataforma de trabajo remoto que ofrece oportunidades verificadas con transparencia salarial en LATAM.',
                'Red de freelancers de 칠lite que acepta solo al 3% superior de los solicitantes para proyectos de alta gama.',
                'Plataforma de freelancers con funciones de "workroom" para la gesti칩n de proyectos y colaboraci칩n.',
                'Plataforma enfocada en el dise침o que se especializa en trabajos creativos a trav칠s de concursos y contrataci칩n directa.',
                'Plataforma con sede en el Reino Unido, popular en Europa, que combina servicios por hora y licitaci칩n de proyectos.',
                'Mercado global de freelancers con sistema de licitaci칩n y pagos basados en hitos.',
                'Plataforma enfocada en startups que conecta empresas con talento tecnol칩gico y oportunidades remotas.',
                'Bolsa de trabajo tradicional con listados de trabajo remoto y herramientas de estimaci칩n salarial.',
                'Plataforma espec칤fica para contratar trabajadores remotos de LATAM con b칰squeda de curr칤culums y publicaci칩n de empleos.',
                'Agencia de cazatalentos para encontrar talento en el extranjero y "nearshore" con hasta un 70% de ahorro de costos.',
                'Mercado de servicios locales para tareas de mantenimiento, con presencia limitada en Am칠rica Latina.',
                'Red de freelancers sin comisiones con un enfoque en portafolios y pagos con criptomonedas.',
                'Red de desarrolladores de 칠lite solo por invitaci칩n con emparejamiento personalizado y altas tarifas por hora.',
                'Plataforma de pagos transfronterizos que conecta a freelancers con redes bancarias locales en m치s de 150 pa칤ses.',
                'Servicio de transferencia de dinero multimoneda con bajas comisiones para pagos internacionales.',
                'Plataforma de trabajo remoto con transparencia salarial y oportunidades en todo el mundo.'
            ],
            'Remote_Jobs': [
                'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤',
                'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤', 'S칤',
                'S칤', 'S칤', 'S칤', 'S칤', 'Limitado', 'S칤', 'S칤', 'N/A', 'N/A', 'S칤'
            ],
            'Target_Audience': [
                'Empresas de EE. UU./Canad치 que contratan asistentes virtuales de Am칠rica Latina', 'Empresas globales que buscan talento de Am칠rica Latina',
                'PYMES y agencias de EE. UU./Canad치 que necesitan personal biling칲e', 'Empresas que desean desarrolladores/profesionales de Am칠rica Latina',
                'Empresas de EE. UU. que contratan profesionales de marketing, finanzas y tecnolog칤a', 'N칩madas digitales y trabajadores remotos a nivel mundial',
                'Buscadores de empleo remoto y empresas de todo el mundo', 'Empresas que priorizan el trabajo remoto y buscadores de empleo a nivel mundial',
                'Trabajadores remotos y empresas globales', 'Profesionales que buscan arreglos de trabajo flexibles',
                'Freelancers y empresas globales', 'Profesionales creativos y compradores de servicios a nivel mundial',
                'Freelancers de Am칠rica Latina y mercados de habla hispana', 'Profesionales de la tecnolog칤a en Am칠rica Latina',
                'Trabajadores remotos en Am칠rica Latina', 'Freelancers de 칠lite y clientes con alto presupuesto',
                'Freelancers y empresas que necesitan gesti칩n de proyectos', 'Dise침adores y empresas creativas',
                'Profesionales y empresas europeas', 'Freelancers globales y compradores de proyectos',
                'Startups y empresas de tecnolog칤a', 'Buscadores de empleo y empleadores a nivel mundial',
                'Empresas que contratan espec칤ficamente trabajadores de LATAM', 'Empresas que buscan talento "nearshore"',
                'Necesidades de servicios locales (LATAM limitado)', 'Profesionales independientes y equipos creativos',
                'Desarrolladores de software de 칠lite y clientes premium', 'Freelancers que reciben pagos internacionales',
                'Usuarios de transferencias de dinero internacionales', 'Buscadores de empleo remoto a nivel mundial'
            ],
            'Qualifications': [
                'Biling칲e (ingl칠s/espa침ol), 2+ a침os de experiencia, nivel de ingl칠s C1, se prefiere t칤tulo universitario',
                'Habilidades espec칤ficas de la industria, dominio del ingl칠s, experiencia laboral relevante',
                'Con educaci칩n universitaria, biling칲e, experiencia profesional en 치reas espec칤ficas',
                'Habilidades t칠cnicas, dominio del ingl칠s, experiencia relevante, portafolio',
                'Calificaciones espec칤ficas del rol, dominio del ingl칠s, experiencia profesional',
                'Habilidades digitales, experiencia en trabajo remoto, portafolio/credenciales',
                'Var칤a seg칰n el rol, a menudo requiere experiencia profesional y habilidades',
                'Calificaciones espec칤ficas del rol, capacidad para trabajar de forma remota',
                'Var칤a seg칰n el puesto, a menudo se requiere experiencia t칠cnica o profesional',
                'Calificaciones profesionales, se requiere suscripci칩n de pago para el acceso',
                'Basado en habilidades, portafolio, rese침as de trabajos anteriores, var칤a seg칰n el proyecto',
                'Habilidades creativas, portafolio, capacidad para ofrecer servicios de alcance fijo',
                'Fluidez en espa침ol/portugu칠s, habilidades profesionales relevantes',
                'Habilidades tecnol칩gicas, se prefiere experiencia en startups, a menudo se requiere ser biling칲e',
                'Experiencia profesional, a menudo calificaciones enfocadas en tecnolog칤a',
                'Talento del 3% superior, selecci칩n rigurosa, pruebas t칠cnicas, amplia experiencia',
                'Habilidades profesionales, portafolio, capacidad para trabajar en un entorno colaborativo',
                'Portafolio de dise침o, habilidades creativas, capacidad de participaci칩n en concursos',
                'Habilidades profesionales, se prefiere conocimiento del mercado europeo',
                'Demostraci칩n de habilidades, portafolio, capacidad de licitaci칩n',
                'Experiencia en startups, habilidades tecnol칩gicas, roles a menudo enfocados en acciones (equity)',
                'Var칤a seg칰n la publicaci칩n del trabajo, calificaciones de empleo tradicionales',
                'Residencia en LATAM, habilidades profesionales, a menudo se prefiere ser biling칲e',
                'Calificaciones espec칤ficas del rol, experiencia nearshore/offshore',
                'Se requiere presencia local, habilidades de manitas/servicios',
                'Portafolio, 16+ a침os, identificaci칩n v치lida para verificaci칩n',
                'Solo por invitaci칩n, habilidades excepcionales, amplia experiencia, desarrolladores de primer nivel',
                'N/A - Plataforma de pago', 'N/A - Plataforma de pago',
                'Calificaciones profesionales, capacidad para trabajar de forma remota'
            ],
            'URL': [
                'virtuallatinos.com', 'remotelatinos.com', 'freelancelatam.com', 'hireinsouth.com',
                'hirelatam.com', 'workingnomads.com', 'remote.co', 'weworkremotely.com',
                'remoteok.com', 'flexjobs.com', 'upwork.com', 'fiverr.com', 'workana.com',
                'getonbrd.com', 'dynamitejobs.com', 'toptal.com', 'guru.com', '99designs.com',
                'peopleperhour.com', 'freelancer.com', 'angel.co', 'indeed.com',
                'prosmarketplace.com', 'somewhere.com', 'taskrabbit.com', 'contra.com',
                'gun.io', 'payoneer.com', 'wise.com', 'remoterocketship.com'
            ],
            'Reliability_Indicators': [
                'Plataforma establecida, pruebas de ingl칠s, testimonios de clientes',
                'Talento verificado, historias de 칠xito de clientes, precios transparentes',
                'Servicio totalmente gestionado, m치s de 7 a침os de operaci칩n, m치s de 80 clientes satisfechos',
                'Proceso de contrataci칩n de 21 d칤as, enfoque basado en equipo, reputaci칩n establecida',
                'Candidatos preseleccionados, garant칤a de reemplazo de 90 d칤as, proceso establecido',
                'Listados curados, alcance global, plataforma establecida',
                'Trabajos seleccionados a mano, enfoque en remoto leg칤timo, reputaci칩n establecida',
                'Confiado por grandes marcas, alto volumen de trabajos, plataforma establecida',
                'Actualizaciones en tiempo real, alcance global, alto volumen de tr치fico',
                'Modelo de suscripci칩n de pago, verificaci칩n de trabajos, establecido desde 2007',
                'Gran base de usuarios, sistema de rese침as, pagos en custodia (escrow), plataforma establecida',
                'Plataforma establecida, sistema de rese침as, protecci칩n de pagos',
                'Enfoque regional, establecido en el mercado de LATAM, soporte de pagos locales',
                'Enfocado en tecnolog칤a, reputaci칩n regional, listados curados',
                'Transparencia salarial, oportunidades verificadas, plataforma emergente',
                'Selecci칩n rigurosa, aceptaci칩n del 3% superior, reputaci칩n premium',
                'Funciones de "workroom", plataforma establecida, herramientas colaborativas',
                'Especializaci칩n en dise침o, modelo de concurso, reputaci칩n establecida',
                'Con sede en el Reino Unido, enfoque europeo, sistema de certificaci칩n',
                'Gran plataforma global, pagos por hitos, sistema establecido',
                'Enfoque en startups, reputaci칩n tecnol칩gica, respaldo de capital de riesgo',
                'Importante bolsa de trabajo, amplio alcance, marca establecida',
                'Enfoque espec칤fico en LATAM, contrataci칩n basada en b칰squeda',
                'Gu칤as salariales, enfoque especializado, reputaci칩n de cazatalentos',
                'Adquisici칩n por parte de IKEA, plataforma importante, enfoque en servicios locales',
                'Modelo sin comisiones, plataforma emergente, enfoque en portafolio',
                'Solo por invitaci칩n, reputaci칩n de 칠lite, fundada por desarrolladores',
                'Soporte en m치s de 150 pa칤ses, plataforma de pago establecida',
                'Bajas comisiones, multimoneda, servicio de transferencia de dinero establecido',
                'Transparencia salarial, alcance global, listados completos'
            ],
            'Potential_Risks': [
                'Competencia por los puestos, barreras por el requisito de ingl칠s',
                'Altos est치ndares pueden limitar oportunidades, consideraciones de costo para empleadores',
                'Tarifas mensuales, flexibilidad limitada en los t칠rminos de contrataci칩n',
                'Limitado a regiones espec칤ficas, el proceso de 21 d칤as puede ser lento',
                'Per칤odo de prueba de 90 d칤as, limitaciones de roles espec칤ficos',
                'Competencia del grupo de talentos global',
                'Limitaciones de acceso basadas en suscripci칩n, restricciones geogr치ficas',
                'Alta competencia, tarifa de publicaci칩n de $299 para empleadores',
                'Alta competencia, la calidad var칤a entre los listados',
                'Se requiere suscripci칩n de pago, acceso gratuito limitado',
                'Tarifas de la plataforma, alta competencia, presi칩n sobre las tarifas',
                'Carrera hacia el fondo en precios, alta competencia',
                'Limitaciones regionales, barreras idiom치ticas para quienes no hablan espa침ol',
                'Limitado a roles de tecnolog칤a, enfoque regional',
                'Plataforma m치s peque침a, volumen de trabajos limitado',
                'Extremadamente competitivo, altos requisitos de habilidades, tarifas caras',
                'Tarifas de la plataforma, competencia',
                'Riesgos del modelo de concurso, enfoque especializado',
                'El enfoque europeo puede limitar las oportunidades globales',
                'Tarifas de la plataforma, competencia en licitaciones, retrasos en los pagos',
                'Volatilidad de las startups, compensaci칩n con muchas acciones (equity)',
                'Competencia, volumen de solicitudes, no espec칤fico para remoto',
                'Plataforma m치s peque침a, variedad de trabajos limitada',
                'Plataforma menos establecida, escala limitada',
                'Presencia muy limitada en Am칠rica Latina',
                'Dependencia del portafolio, plataforma m치s nueva, suscripci칩n Pro para funciones completas',
                'Acceso solo por invitaci칩n, est치ndares extremadamente altos',
                'Tarifas de transferencia, costos de conversi칩n de moneda',
                'Tarifas de transferencia, limitaciones regulatorias en algunos pa칤ses',
                'Competencia en la plataforma, calidad variable de los trabajos'
            ],
            'How_to_Get_Paid': [
                'Wise, Payoneer, PayPal, Uphold - pagos quincenales a trav칠s de Virtual Latinos',
                'Pago directo a trav칠s de la empresa, modelo de ahorro de costos del 80%',
                'Pago mensual 칰nico a trav칠s de bill.com, ACH o transferencia bancaria',
                'Pago directo, tarifas de mercado, modelo de tarifa mensual',
                'Pago directo al freelancer, varios m칠todos internacionales',
                'Pago directo del empleador, var칤a seg칰n la publicaci칩n del trabajo',
                'Pago directo del empleador, var칤a seg칰n la empresa',
                'Pago directo del empleador, basado en la aplicaci칩n',
                'Pago directo del empleador, var칤a seg칰n la empresa',
                'Contacto y pago directo del empleador, modelo de suscripci칩n',
                'Sistema de pago de Upwork, transferencias semanales, PayPal/banco',
                'Sistema de pago de Fiverr, PayPal, transferencia bancaria, retenci칩n de 14 d칤as',
                'Sistema de pago de la plataforma, varios m칠todos locales',
                'Pago directo del empleador, var칤a seg칰n la empresa',
                'Pago directo del empleador, informaci칩n salarial transparente',
                'Gestionado por la plataforma, altas tarifas por hora ($100-200/h), pagos semanales',
                'Sistema de pago de Guru, SafePay escrow, varios m칠todos de retiro',
                'Pago de la plataforma despu칠s de la finalizaci칩n del concurso o la entrega del proyecto',
                'Sistema de pago de la plataforma, varias opciones de retiro',
                'Pagos por hitos, PayPal, Skrill, Payoneer, transferencia bancaria',
                'Pago directo del empleador, a menudo acciones (equity) + salario',
                'Pago directo del empleador, var칤a seg칰n la empresa',
                'Pago directo del empleador, la plataforma lo facilita',
                'Pago directo del empleador, gestionado por la plataforma',
                'Sistema de pago de TaskRabbit, pagos semanales, dep칩sito directo',
                'Pago directo, sin comisi칩n, moneda fiduciaria o cripto USDC',
                'Gestionado por la plataforma, t칤pico $100-200/h, tarifas de alta gama',
                'Transferencias internacionales a m치s de 150 pa칤ses, multimoneda',
                'Transferencias internacionales, bajas comisiones, tasas del mercado medio',
                'Pago directo del empleador, var칤a seg칰n la empresa'
            ],
            'Application_Requirements': [
                'Prueba de ingl칠s EF SET (nivel C1), ID v치lida, 2+ a침os de experiencia, m칤nimo bachillerato',
                'Evaluaci칩n de habilidades, revisi칩n de portafolio, proceso de entrevista',
                'Revisi칩n de solicitud, verificaci칩n de habilidades, evaluaci칩n de ajuste cultural',
                'Evaluaci칩n de habilidades t칠cnicas, revisi칩n de portafolio, entrevista',
                'Selecci칩n de solicitudes, verificaci칩n de habilidades, verificaci칩n de antecedentes',
                'Env칤o de curr칤culum/portafolio, solicitud directa a los empleadores',
                'Solicitud directa a los trabajos publicados, var칤a seg칰n el empleador',
                'Solicitud a trav칠s de la publicaci칩n de trabajo, requisitos espec칤ficos del empleador',
                'Solicitud directa a las empresas, curr칤culum y portafolio',
                'Suscripci칩n de pago, solicitud a trav칠s de la plataforma',
                'Creaci칩n de perfil, pruebas de habilidades, portafolio, redacci칩n de propuestas',
                'Configuraci칩n de perfil, creaci칩n de "gigs", exhibici칩n de portafolio',
                'Creaci칩n de perfil, dominio de espa침ol/portugu칠s, portafolio',
                'Env칤o de CV, demostraci칩n de habilidades tecnol칩gicas, portafolio',
                'Solicitud a trav칠s de la plataforma, revisi칩n de calificaciones',
                'Selecci칩n rigurosa: prueba de habilidades, entrevista t칠cnica, revisi칩n de proyecto',
                'Creaci칩n de perfil, demostraci칩n de habilidades, historial laboral',
                'Env칤o de portafolio, participaci칩n en concursos, habilidades de dise침o',
                'Creaci칩n de perfil, certificaci칩n de habilidades, muestras de trabajo',
                'Configuraci칩n de perfil, pruebas de habilidades, licitaci칩n en proyectos',
                'Solicitud a trav칠s de publicaciones de trabajo, networking en el ecosistema de startups',
                'Carga de curr칤culum, solicitud directa a trabajos',
                'B칰squeda de curr칤culums por parte de los empleadores, tarifa de publicaci칩n de trabajo de $79',
                'Revisi칩n de solicitud, evaluaci칩n de habilidades, ajuste cultural',
                'Verificaci칩n de antecedentes, verificaci칩n de habilidades, presencia en el mercado local',
                'Creaci칩n de portafolio, verificaci칩n de ID v치lida, 16+ a침os',
                'Solo por invitaci칩n, demostraci칩n de habilidades excepcionales, entrevista t칠cnica',
                'N/A - Registro en servicio de pago', 'N/A - Registro en servicio de transferencia de dinero',
                'Env칤o de curr칤culum, solicitud directa a los trabajos publicados'
            ]
        };

        // Convertir el objeto de arrays en un array de objetos para un manejo m치s f치cil
        let jobs = comprehensiveJobSources.Website.map((website, index) => {
            const entry = {};
            for (const key in comprehensiveJobSources) {
                entry[key] = comprehensiveJobSources[key][index];
            }
            return entry;
        });

        // Funci칩n para procesar y asignar etiquetas a una entrada de trabajo
        function processTags(job) {
            const tags = new Set(job.Tags || []);
            const lowercaseWebsite = job.Website.toLowerCase();
            const lowercaseDescription = job.Description.toLowerCase();
            const lowercaseQualifications = (job.Qualifications || '').toLowerCase();
            
            if (lowercaseDescription.includes('am칠rica latina') || lowercaseDescription.includes('latam') || lowercaseWebsite.includes('latinos') || lowercaseWebsite.includes('latam')) {
                tags.add('Foco LATAM');
            }
            if (lowercaseWebsite.includes('freelance') || lowercaseDescription.includes('freelance') || ['upwork', 'fiverr', 'toptal', 'guru', '99designs', 'peopleperhour', 'workana', 'contra'].some(f => lowercaseWebsite.includes(f))) {
                tags.add('Freelance');
            }
            if (lowercaseWebsite.includes('gun.io') || lowercaseWebsite.includes('toptal') || lowercaseWebsite.includes('angel') || lowercaseDescription.includes('tecnolog칤a') || lowercaseDescription.includes('desarrollador') || lowercaseWebsite.includes('get on board')) {
                tags.add('Tecnolog칤a');
            }
            if (lowercaseWebsite.includes('payoneer') || lowercaseWebsite.includes('wise')) {
                tags.add('Plataforma de Pagos');
            }
            if (lowercaseQualifications.includes('ingl칠s') || lowercaseDescription.includes('ingl칠s') || lowercaseQualifications.includes('biling칲e')) {
                tags.add('Ingl칠s');
            }
            if (lowercaseQualifications.includes('espa침ol') || lowercaseDescription.includes('espa침ol') || lowercaseQualifications.includes('portugu칠s') || lowercaseQualifications.includes('biling칲e')) {
                tags.add('Espa침ol');
            }
            job.Tags = Array.from(tags);
        }

        // A침adir etiquetas a cada entrada de trabajo
        jobs.forEach(processTags);

        // A침adir insignias de recomendado a las fuentes principales
        jobs[0].isRecommended = true; // Virtual Latinos
        jobs[1].isRecommended = true; // Remote Latinos
        jobs[10].isRecommended = true; // Upwork


        // Referencias a elementos del DOM
        const searchBar = document.getElementById('search-bar');
        const jobListingsContainer = document.getElementById('job-listings-container');
        const gridViewBtn = document.getElementById('grid-view-btn');
        const listViewBtn = document.getElementById('list-view-btn');
        const tagContainer = document.getElementById('tag-container');
        const themeToggleBtn = document.getElementById('theme-toggle');
        const addModal = document.getElementById('add-modal');
        const addNewBtn = document.getElementById('add-new-btn');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const loginForm = document.getElementById('login-form');
        const dataEntryContainer = document.getElementById('data-entry-container');
        const modalTitle = document.getElementById('modal-title');
        const loginMessage = document.getElementById('login-message');
        const addDataForm = document.getElementById('add-data-form');
        const csvUploadInput = document.getElementById('csv-upload');
        const uploadCsvBtn = document.getElementById('upload-csv-btn');
        const existingTagsContainer = document.getElementById('existing-tags-container');
        const selectedTagsContainer = document.getElementById('selected-tags-container');

        let currentView = 'grid'; // 'grid' o 'list'
        let activeFilter = 'Todos';
        let modalSelectedTags = new Set();

        // Funci칩n para crear un elemento HTML con clases y contenido
        function createElement(tag, classes = [], content = '') {
            const el = document.createElement(tag);
            el.classList.add(...classes);
            if (typeof content === 'string') {
                el.innerHTML = content;
            } else if (content) {
                el.appendChild(content);
            }
            return el;
        }

        // Funci칩n para renderizar los listados de trabajos
        function renderJobs(filteredJobs) {
            jobListingsContainer.innerHTML = ''; // Limpiar contenido existente
            jobListingsContainer.classList.remove('grid-view', 'list-view');
            jobListingsContainer.classList.add(`${currentView}-view`);
            
            if (currentView === 'grid') {
                jobListingsContainer.classList.add('grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3');
            } else {
                jobListingsContainer.classList.remove('grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3');
            }

            if (filteredJobs.length === 0) {
                const noResults = createElement('p', ['text-center', 'text-gray-500', 'dark:text-gray-400', 'text-xl', 'col-span-full', 'py-10'], 'No se encontraron resultados.');
                jobListingsContainer.appendChild(noResults);
                return;
            }

            filteredJobs.forEach(job => {
                const card = createElement('div', ['job-card', 'rounded-xl', 'shadow-md', 'p-6', 'flex', 'flex-col', 'border', 'transition-all', 'duration-300']);

                // --- Contenido de la Vista de Cuadr칤cula ---
                const gridContent = createElement('div', ['job-card-grid-content', 'space-y-4']);
                const headerContainer = createElement('div', ['flex', 'items-center', 'justify-between']);
                const titleGroup = createElement('div', ['flex', 'items-center', 'min-w-0']);
                const icon = createElement('div', ['flex-shrink-0'], `<i data-lucide="building-2" class="w-6 h-6 text-primary mr-3"></i>`);
                const titleContent = createElement('div', ['min-w-0']);
                const gridTitle = createElement('h2', ['text-xl', 'font-bold', 'text-gray-900', 'dark:text-gray-100', 'truncate'], job.Website);
                
                titleContent.appendChild(gridTitle);
                titleGroup.appendChild(icon);
                titleGroup.appendChild(titleContent);
                headerContainer.appendChild(titleGroup);

                if (job.isRecommended) {
                    const badge = createElement('img');
                    badge.src = 'https://bucket.mlcdn.com/a/3336/3336910/images/596d184d246afd7cd39f546aa38386ee16ef4e5f.png';
                    badge.alt = 'Fuente Recomendada';
                    badge.className = 'w-10 h-10 object-contain ml-3 flex-shrink-0';
                    headerContainer.appendChild(badge);
                }
                
                const description = createElement('p', ['text-gray-600', 'dark:text-gray-300', 'text-sm'], job.Description);
                const tagsContainer = createElement('div', ['flex', 'flex-wrap', 'gap-2']);
                (job.Tags || []).forEach(tag => {
                    const tagEl = createElement('span', ['px-2', 'py-1', 'text-xs', 'font-semibold', 'bg-gray-200', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300', 'rounded-full'], tag);
                    tagsContainer.appendChild(tagEl);
                });
                gridContent.appendChild(headerContainer);
                gridContent.appendChild(description);
                gridContent.appendChild(tagsContainer);

                // --- Contenido de la Vista de Lista ---
                const listContent = createElement('div', ['job-card-list-content', 'list-view-card', 'md:items-center', 'space-y-4', 'md:space-y-0', 'md:space-x-4']);
                
                const listTitleContainer = createElement('div', ['flex', 'items-center', 'justify-between', 'w-full']);
                const listTitleIconGroup = createElement('div', ['flex', 'items-center', 'min-w-0']);

                listTitleIconGroup.innerHTML = `<i data-lucide="building-2" class="w-5 h-5 text-primary mr-3 flex-shrink-0"></i>`;
                const listTitleGroup = createElement('div', ['min-w-0']);
                const listTitle = createElement('h3', ['text-lg', 'font-bold', 'text-gray-900', 'dark:text-gray-100', 'truncate'], job.Website);
                const listUrl = createElement('a', ['text-sm', 'text-gray-500', 'dark:text-gray-400', 'hover:underline', 'truncate', 'block'], job.URL);
                listUrl.href = `https://${job.URL}`;
                listUrl.target = "_blank";
                listTitleGroup.appendChild(listTitle);
                listTitleGroup.appendChild(listUrl);
                listTitleIconGroup.appendChild(listTitleGroup);
                listTitleContainer.appendChild(listTitleIconGroup);

                if (job.isRecommended) {
                    const badge = createElement('img');
                    badge.src = 'https://bucket.mlcdn.com/a/3336/3336910/images/596d184d246afd7cd39f546aa38386ee16ef4e5f.png';
                    badge.alt = 'Fuente Recomendada';
                    badge.className = 'w-10 h-10 object-contain ml-3 flex-shrink-0';
                    listTitleContainer.appendChild(badge);
                }
                
                const listDescription = createElement('p', ['text-sm', 'text-gray-600', 'dark:text-gray-300'], job.Description);
                const reliabilityTag = createElement('p', ['text-xs', 'md:text-right', 'text-gray-500', 'dark:text-gray-400', 'truncate'], job.Reliability_Indicators.split(',')[0].trim());
                
                listContent.appendChild(listTitleContainer);
                listContent.appendChild(listDescription);
                listContent.appendChild(reliabilityTag);
                
                // --- Detalles Desplegables ---
                const detailsContainer = createElement('div', ['collapsible-content', 'mt-4', 'pt-4', 'border-t']);
                const details = [
                    { title: 'P칰blico Objetivo', content: job.Target_Audience },
                    { title: 'Requisitos', content: job.Qualifications },
                    { title: 'Indicadores de Confianza', content: job.Reliability_Indicators },
                    { title: 'Riesgos Potenciales', content: job.Potential_Risks },
                    { title: 'C칩mo Recibir Pagos', content: job.How_to_Get_Paid },
                    { title: 'Requisitos de Aplicaci칩n', content: job.Application_Requirements },
                ];
                
                details.forEach(detail => {
                    if(detail.content && detail.content.trim() !== '' && detail.content.trim().toLowerCase() !== 'n/a'){
                        const detailEl = createElement('div', ['mb-3']);
                        const detailTitle = createElement('h4', ['text-sm', 'font-bold', 'text-gray-900', 'dark:text-gray-100'], detail.title);
                        const detailContent = createElement('p', ['text-sm', 'text-gray-600', 'dark:text-gray-300'], detail.content);
                        detailEl.appendChild(detailTitle);
                        detailEl.appendChild(detailContent);
                        detailsContainer.appendChild(detailEl);
                    }
                });

                // Funci칩n de Copiar URL
                const urlContainer = createElement('div', ['mt-4', 'flex', 'items-center', 'justify-between', 'bg-gray-100', 'dark:bg-gray-800', 'p-2', 'rounded-md']);
                const urlText = createElement('span', ['text-sm', 'text-gray-500', 'dark:text-gray-400', 'truncate', 'mr-2', 'font-mono'], `https://${job.URL}`);
                const copyButton = createElement('button', ['p-1.5', 'rounded', 'hover:bg-gray-200', 'dark:hover:bg-gray-600', 'transition-colors']);
                copyButton.innerHTML = '<i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>';
                
                copyButton.onclick = (e) => {
                    e.stopPropagation();
                    navigator.clipboard.writeText(`https://${job.URL}`).then(() => {
                        copyButton.innerHTML = '<i data-lucide="check" class="w-4 h-4 text-green-500"></i>';
                        setTimeout(() => {
                            copyButton.innerHTML = '<i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>';
                            lucide.createIcons();
                        }, 2000);
                    });
                };
                urlContainer.appendChild(urlText);
                urlContainer.appendChild(copyButton);
                detailsContainer.appendChild(urlContainer);
                
                const websiteButton = createElement('a', ['mt-4', 'w-full', 'inline-flex', 'items-center', 'justify-center', 'px-4', 'py-2', 'text-sm', 'font-medium', 'rounded-full', 'text-white', 'bg-primary', 'hover:bg-primary/80', 'transition-colors', 'duration-300', 'shadow-md'], 'Visitar Sitio Web');
                websiteButton.href = `https://${job.URL}`;
                websiteButton.target = "_blank";
                websiteButton.onclick = (e) => e.stopPropagation();
                
                card.appendChild(gridContent);
                card.appendChild(listContent);
                card.appendChild(detailsContainer);
                
                const footer = createElement('div', ['mt-auto', 'pt-4']);
                footer.appendChild(websiteButton);
                card.appendChild(footer);

                card.addEventListener('click', () => {
                    detailsContainer.classList.toggle('expanded');
                });
                
                jobListingsContainer.appendChild(card);
            });
            lucide.createIcons();
        }

        function filterJobs() {
            const query = searchBar.value.toLowerCase();
            const filtered = jobs.filter(job => {
                const matchesSearch = job.Website.toLowerCase().includes(query) ||
                                      job.Description.toLowerCase().includes(query) ||
                                      ((job.Tags || []).some(tag => tag.toLowerCase().includes(query)));
                const matchesFilter = activeFilter === 'Todos' || ((job.Tags || []).includes(activeFilter));
                return matchesSearch && matchesFilter;
            });
            renderJobs(filtered);
        }

        // Actualizar los botones de filtro de etiquetas principales
        function updateMainTagFilters() {
            const allTags = [...new Set(jobs.flatMap(job => job.Tags || []))].sort();
            tagContainer.innerHTML = ''; // Limpiar etiquetas existentes

            const allButton = createElement('button', ['tag-filter', 'px-4', 'py-2', 'text-sm', 'font-semibold', 'rounded-full', 'border', 'border-gray-300', 'dark:border-gray-600'], 'Todos');
            allButton.dataset.filter = 'Todos';
            tagContainer.appendChild(allButton);

            allTags.forEach(tag => {
                const tagButton = createElement('button', ['tag-filter', 'px-4', 'py-2', 'text-sm', 'font-semibold', 'rounded-full', 'border', 'border-gray-300', 'dark:border-gray-600', 'bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300', 'hover:bg-primary', 'hover:text-white', 'transition-all', 'duration-300'], tag);
                tagButton.dataset.filter = tag;
                tagContainer.appendChild(tagButton);
            });

            // Re-aplicar estilo activo
            const currentActiveButton = tagContainer.querySelector(`[data-filter="${activeFilter}"]`) || allButton;
            currentActiveButton.classList.add('bg-primary', 'text-white');
            currentActiveButton.classList.remove('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
        }

        function populateModalTags() {
            const allTags = [...new Set(jobs.flatMap(job => job.Tags || []))].sort();
            existingTagsContainer.innerHTML = '';
            allTags.forEach(tag => {
                const tagButton = createElement('button', ['px-2', 'py-1', 'text-xs', 'font-semibold', 'bg-gray-200', 'dark:bg-gray-600', 'text-gray-700', 'dark:text-gray-300', 'rounded-full', 'hover:bg-primary', 'hover:text-white', 'transition-colors'], tag);
                tagButton.type = 'button'; // Prevenir env칤o de formulario
                tagButton.addEventListener('click', () => {
                    toggleModalTag(tag);
                });
                existingTagsContainer.appendChild(tagButton);
            });
        }

        function toggleModalTag(tag) {
            if (modalSelectedTags.has(tag)) {
                modalSelectedTags.delete(tag);
            } else {
                modalSelectedTags.add(tag);
            }
            renderModalSelectedTags();
        }

        function renderModalSelectedTags() {
            selectedTagsContainer.innerHTML = '';
            modalSelectedTags.forEach(tag => {
                const tagEl = createElement('span', ['px-2', 'py-1', 'text-xs', 'font-semibold', 'bg-primary', 'text-white', 'rounded-full', 'flex', 'items-center', 'gap-1'], tag);
                const removeBtn = createElement('button', [], '&times;');
                removeBtn.type = 'button';
                removeBtn.onclick = () => toggleModalTag(tag);
                tagEl.appendChild(removeBtn);
                selectedTagsContainer.appendChild(tagEl);
            });
        }

        // Configuraci칩n de los Event Listeners
        function setupEventListeners() {
            searchBar.addEventListener('input', filterJobs);

            gridViewBtn.addEventListener('click', () => {
                currentView = 'grid';
                gridViewBtn.classList.add('bg-primary', 'text-white');
                gridViewBtn.classList.remove('bg-gray-300', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300');
                listViewBtn.classList.remove('bg-primary', 'text-white');
                listViewBtn.classList.add('bg-gray-300', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300');
                filterJobs();
            });

            listViewBtn.addEventListener('click', () => {
                currentView = 'list';
                listViewBtn.classList.add('bg-primary', 'text-white');
                listViewBtn.classList.remove('bg-gray-300', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300');
                gridViewBtn.classList.remove('bg-primary', 'text-white');
                gridViewBtn.classList.add('bg-gray-300', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300');
                filterJobs();
            });

            tagContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('tag-filter')) {
                    const allTagFilters = tagContainer.querySelectorAll('.tag-filter');
                    allTagFilters.forEach(t => {
                        t.classList.remove('bg-primary', 'text-white');
                        t.classList.add('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    });
                    e.target.classList.add('bg-primary', 'text-white');
                    e.target.classList.remove('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    activeFilter = e.target.dataset.filter;
                    filterJobs();
                }
            });

            themeToggleBtn.addEventListener('click', () => {
                document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
            });

            addNewBtn.addEventListener('click', () => {
                populateModalTags();
                addModal.classList.remove('hidden');
            });

            modalCloseBtn.addEventListener('click', () => {
                addModal.classList.add('hidden');
                loginForm.classList.remove('hidden');
                dataEntryContainer.classList.add('hidden');
                modalTitle.textContent = "Acceso de Administrador";
                loginMessage.textContent = "";
                loginForm.reset();
                addDataForm.reset();
                modalSelectedTags.clear();
                renderModalSelectedTags();
            });

            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                if (username === 'Bebell' && password === 'Bebell/25') {
                    loginMessage.textContent = "춰Inicio de sesi칩n exitoso!";
                    loginMessage.className = 'text-center text-sm font-medium text-green-500';
                    setTimeout(() => {
                      loginForm.classList.add('hidden');
                      dataEntryContainer.classList.remove('hidden');
                      modalTitle.textContent = "A침adir Nueva Entrada";
                    }, 500);
                } else {
                    loginMessage.textContent = "Nombre de usuario o contrase침a inv치lidos.";
                    loginMessage.className = 'text-center text-sm font-medium text-red-500';
                }
            });

            addDataForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const inputTags = document.getElementById('new-tags').value.split(',').map(t => t.trim()).filter(Boolean);
                const finalTags = new Set([...modalSelectedTags, ...inputTags]);

                const newEntry = {
                    'Website': document.getElementById('website').value,
                    'Description': document.getElementById('description').value,
                    'Remote_Jobs': document.getElementById('remote-jobs').value,
                    'Target_Audience': document.getElementById('target-audience').value,
                    'Qualifications': document.getElementById('qualifications').value,
                    'URL': document.getElementById('url').value.replace(/^(https?:\/\/)/, ''),
                    'Reliability_Indicators': document.getElementById('reliability-indicators').value,
                    'Potential_Risks': document.getElementById('potential-risks').value,
                    'How_to_Get_Paid': document.getElementById('how-to-get-paid').value,
                    'Application_Requirements': document.getElementById('application-requirements').value,
                    'isRecommended': document.getElementById('is-recommended').checked,
                    'Tags': Array.from(finalTags)
                };
                
                processTags(newEntry); // Ejecutar etiquetado autom치tico tambi칠n
                jobs.push(newEntry);
                updateMainTagFilters(); // Actualizar la lista de filtros principales
                filterJobs();
                modalCloseBtn.click();
            });

            uploadCsvBtn.addEventListener('click', () => {
                const file = csvUploadInput.files[0];
                if (!file) {
                    alert("Por favor, selecciona un archivo CSV para subir.");
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(event) {
                    const csvData = event.target.result;
                    const lines = csvData.split('\n');
                    const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
                    for (let i = 1; i < lines.length; i++) {
                        if (lines[i].trim() === '') continue;
                        const values = lines[i].match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g).map(v => v.trim().replace(/"/g, ''));
                        const newEntry = {};
                        headers.forEach((h, index) => { newEntry[h.replace(/\s/g, '_')] = values[index] || ''; });
                        processTags(newEntry);
                        jobs.push(newEntry);
                    }
                    updateMainTagFilters();
                    filterJobs();
                    modalCloseBtn.click();
                };
                reader.readAsText(file);
            });
        }

        // Configuraci칩n inicial
        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            
            updateMainTagFilters();
            filterJobs();
            setupEventListeners();
            lucide.createIcons();
        });
    </script>
</body>
</html>
