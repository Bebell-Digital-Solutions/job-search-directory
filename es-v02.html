<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Directorio de Búsqueda de Empleo</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the app. The primary color is #df1783 */
         /* Replace your current :root styles with these */
    :root {
        --primary: #DF1783;
        --primary-light: #f8a4d4;
        --secondary: #2d3748;
        --accent: #4fd1c5;
        --text: #2d3748;
        --text-light: #f7fafc;
        --bg: #f7fafc;
        --card-bg: #ffffff;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --border-color: #e2e8f0;
    }

    /* Updated from .dark-mode to .dark to match Tailwind's convention and the JS implementation */
    .dark {
        --primary: #DF1783;
        --primary-light: #4a1a38;
        --secondary: #1e2837;
        --accent: #4fd1c5;
        --text: #f7fafc;
        --text-light: #2d3748;
        --bg: #1a202c;
        --card-bg: #2d3748;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.2), 0 2px 4px -1px rgba(0, 0, 0, 0.1);
        --border-color: #4a5568;
    }
    
      body {
        background-color: var(--bg);
        color: var(--text);
    }
  
        .text-primary {
            color: var(--primary);
        }
        
        .bg-primary {
            background-color: var(--primary);
        }
        
        .border-primary {
            border-color: var(--primary);
        }
        
        .hover-bg-primary:hover {
            background-color: var(--primary-light);
        }
        
        .job-card {
            background-color: var(--card-bg);
            border-color: var(--border-color);
            box-shadow: var(--shadow);
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            cursor: pointer;
        }
        
        .job-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .list-view-card {
            display: grid;
            grid-template-columns: 1fr;
        }
        
        @media (min-width: 768px) {
            .list-view-card {
                grid-template-columns: 2fr 3fr 1fr;
            }
        }
        .list-view .job-card-grid-content {
            display: none;
        }
        .grid-view .job-card-list-content {
            display: none;
        }
        /* Style for the scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .dark ::-webkit-scrollbar-track {
            background: #2d3748;
        }
        .dark ::-webkit-scrollbar-thumb {
            background: #4a5568;
        }
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #718096;
        }
        /* Collapsible content animation */
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .collapsible-content.expanded {
            max-height: 1000px; /* A large value to allow for expansion */
            transition: max-height 0.5s ease-in;
        }
    </style>
    <!-- Lucide Icons CDN -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="font-sans antialiased min-h-screen flex flex-col transition-colors duration-300">

    <!-- Theme Toggle Floating Button -->
    <button id="theme-toggle" class="fixed top-4 left-4 p-3 bg-white dark:bg-gray-800 rounded-full shadow-lg z-50 transition-transform transform hover:scale-110 focus:outline-none">
        <i data-lucide="moon" class="w-6 h-6 text-gray-800 dark:hidden"></i>
        <i data-lucide="sun" class="w-6 h-6 text-yellow-400 hidden dark:block"></i>
    </button>

    <!-- Main Content Container -->
    <div class="container mx-auto p-4 md:p-8 flex-grow">
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-5xl font-bold dark:text-white mb-2">Directorio de Búsqueda de Empleo</h1>
            <p class="text-lg md:text-xl text-gray-600 dark:text-gray-400">Encuentra las mejores fuentes de trabajo remoto y freelance.</p>
        </header>

        <!-- Search, View Controls, and Add button -->
        <div class="flex flex-col md:flex-row items-center justify-center md:justify-between mb-8 space-y-4 md:space-y-0">
            <!-- Search Bar Container -->
            <div class="relative w-full md:w-2/3 mx-auto">
                <input type="text" id="search-bar" placeholder="Buscar por sitio web, etiqueta o descripción..." class="w-full pl-10 pr-4 py-3 rounded-full border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-all duration-300">
                <i data-lucide="search" class="absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 dark:text-gray-500"></i>
            </div>
            <!-- View Buttons -->
            <div class="flex items-center space-x-2 md:mt-0">
                <button id="grid-view-btn" class="p-2 rounded-full bg-primary text-white shadow-md focus:outline-none hover-bg-primary transition-all duration-300">
                    <i data-lucide="layout-grid" class="w-6 h-6"></i>
                </button>
                <button id="list-view-btn" class="p-2 rounded-full bg-gray-300 dark:bg-gray-600 text-gray-600 dark:text-gray-300 shadow-md focus:outline-none hover:bg-gray-400 dark:hover:bg-gray-500 transition-all duration-300">
                    <i data-lucide="list" class="w-6 h-6"></i>
                </button>
            </div>
        </div>

        <!-- Filter Tags -->
        <div id="tag-container" class="flex flex-wrap gap-2 justify-center mb-8">
            <!-- Tags will be dynamically populated here -->
        </div>

        <!-- Job Listings Container -->
        <div id="job-listings-container" class="grid-view grid gap-6 transition-all duration-300">
            <!-- Job cards will be dynamically populated here -->
        </div>

    </div>

    <!-- Floating Add New Button -->
    <button id="add-new-btn" class="fixed bottom-8 right-8 p-4 bg-primary text-white rounded-full shadow-lg z-50 transition-transform transform hover:scale-110 focus:outline-none">
        <i data-lucide="plus" class="w-8 h-8"></i>
    </button>

    <!-- Modal for adding new data -->
    <div id="add-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 z-50 flex items-center justify-center hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-8 w-11/12 md:w-2/3 lg:w-1/2 max-h-[90vh] overflow-y-auto transform scale-95 transition-transform duration-300">
            <div class="flex justify-between items-center mb-4">
                <h2 id="modal-title" class="text-2xl font-bold dark:text-white">Acceso de Administrador</h2>
                <button id="modal-close-btn" class="text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>

            <!-- Login Form -->
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="username" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Nombre de Usuario</label>
                    <input type="text" id="username" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                </div>
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Contraseña</label>
                    <input type="password" id="password" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm focus:border-primary focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                </div>
                <button type="submit" class="w-full py-2 px-4 rounded-md text-white bg-primary hover-bg-primary focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300">Iniciar Sesión</button>
                <p id="login-message" class="text-center text-sm font-medium"></p>
            </form>

            <!-- Data Entry Form (hidden by default) -->
            <div id="data-entry-container" class="hidden">
                <form id="add-data-form" class="space-y-4">
                    <h3 class="text-xl font-bold dark:text-white">Añadir Nueva Entrada</h3>
                    <div>
                        <label for="website" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Sitio Web</label>
                        <input type="text" id="website" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                    </div>
                    <div>
                        <label for="description" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Descripción</label>
                        <textarea id="description" rows="3" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required></textarea>
                    </div>
                    <div>
                        <label for="remote-jobs" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Trabajos Remotos</label>
                        <input type="text" id="remote-jobs" placeholder="Sí/No/N/A" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                    </div>
                    <div>
                        <label for="target-audience" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Público Objetivo</label>
                        <input type="text" id="target-audience" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                    </div>
                    <div>
                        <label for="qualifications" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Requisitos</label>
                        <input type="text" id="qualifications" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                    </div>
                    <div>
                        <label for="url" class="block text-sm font-medium text-gray-700 dark:text-gray-300">URL</label>
                        <input type="url" id="url" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100" required>
                    </div>
                    <div>
                        <label for="reliability-indicators" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Indicadores de Confianza</label>
                        <textarea id="reliability-indicators" rows="2" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"></textarea>
                    </div>
                    <div>
                        <label for="potential-risks" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Riesgos Potenciales</label>
                        <textarea id="potential-risks" rows="2" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"></textarea>
                    </div>
                    <div>
                        <label for="how-to-get-paid" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Cómo Recibir Pagos</label>
                        <textarea id="how-to-get-paid" rows="2" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"></textarea>
                    </div>
                    <div>
                        <label for="application-requirements" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Requisitos de Aplicación</label>
                        <textarea id="application-requirements" rows="2" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"></textarea>
                    </div>
                    <div class="flex items-center pt-2">
                        <input type="checkbox" id="is-recommended" class="h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary">
                        <label for="is-recommended" class="ml-2 block text-sm font-medium text-gray-700 dark:text-gray-300">Marcar como Recomendado</label>
                    </div>
                    <div>
                        <label for="new-tags" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Etiquetas</label>
                        <div id="selected-tags-container" class="flex flex-wrap gap-2 mt-1 mb-2"></div>
                        <input type="text" id="new-tags" placeholder="Añadir nuevas etiquetas, separadas por comas" class="mt-1 block w-full px-3 py-2 rounded-md border-gray-300 dark:border-gray-600 shadow-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100">
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mt-2">O selecciona etiquetas existentes:</label>
                        <div id="existing-tags-container" class="flex flex-wrap gap-2 mt-1 max-h-24 overflow-y-auto p-2 border border-gray-300 dark:border-gray-600 rounded-md">
                            <!-- Existing tags will be populated here by JS -->
                        </div>
                    </div>
                    <button type="submit" class="w-full py-2 px-4 rounded-md text-white bg-primary hover-bg-primary focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300">Añadir Entrada</button>
                </form>

                <div class="my-6 text-center text-gray-500 dark:text-gray-400">
                    <p>o</p>
                </div>

                <div class="space-y-4">
                    <h3 class="text-xl font-bold dark:text-white">Carga Masiva (CSV)</h3>
                    <div>
                        <label for="csv-upload" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Subir Archivo CSV</label>
                        <input type="file" id="csv-upload" accept=".csv" class="mt-1 block w-full text-gray-900 dark:text-gray-100 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary file:text-white hover:file:bg-primary/80 transition-all duration-200">
                    </div>
                    <button id="upload-csv-btn" class="w-full py-2 px-4 rounded-md text-white bg-primary hover-bg-primary focus:outline-none focus:ring-2 focus:ring-primary transition-all duration-300">Subir CSV</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Datos de la solicitud del usuario (traducidos al español)
        const comprehensiveJobSources = {
            'Website': [
                'Virtual Latinos', 'Remote Latinos', 'Freelance Latin America', 'South (HireInSouth)', 'HireLATAM',
                'Working Nomads', 'Remote.co', 'We Work Remotely', 'RemoteOK', 'FlexJobs', 'Upwork', 'Fiverr',
                'Workana', 'Get on Board', 'Dynamite Jobs', 'Toptal', 'Guru', '99designs', 'PeoplePerHour',
                'Freelancer.com', 'AngelList', 'Indeed', 'Pros Marketplace', 'Somewhere', 'TaskRabbit',
                'Contra', 'Gun.io', 'Payoneer', 'Wise', 'Remote Rocketship'
            ],
            'Description': [
                'Plataforma de reclutamiento que conecta empresas de EE. UU./Canadá con asistentes virtuales bilingües de América Latina.',
                'Mercado de talento de élite que conecta empresas con los mejores profesionales de América Latina con un ahorro de costos del 80%.',
                'Agencia de personal remoto totalmente gestionada que proporciona talento bilingüe con educación universitaria de LATAM.',
                'Plataforma que ayuda a las empresas a encontrar, contratar y pagar a los mejores talentos de América Latina con un proceso de contratación de 21 días.',
                'Facilita las conexiones entre empresas de EE. UU. y profesionales remotos preseleccionados en diversos campos.',
                'Bolsa de trabajo remota global con listados específicos de América Latina y roles basados en lo digital.',
                'Plataforma de listados de trabajos remotos curados que se enfoca en oportunidades remotas legítimas en todo el mundo.',
                'Gran bolsa de trabajo remota que conecta talento con empresas que priorizan el trabajo remoto a nivel mundial.',
                'Agregador de trabajos remotos en tiempo real con listados globales que incluyen posiciones en América Latina.',
                'Bolsa de trabajo premium basada en suscripción que se especializa en oportunidades de trabajo flexible y remoto.',
                'Mercado global de freelancers con trabajo por proyecto y por hora en todas las categorías.',
                'Mercado basado en "gigs" que ofrece servicios a precio fijo desde $5 en campos creativos.',
                'Mercado de freelancers enfocado en América Latina para profesionales de habla hispana/portuguesa.',
                'Comunidad de empleos de tecnología y startups curada que sirve principalmente a los mercados de América Latina.',
                'Plataforma de trabajo remoto que ofrece oportunidades verificadas con transparencia salarial en LATAM.',
                'Red de freelancers de élite que acepta solo al 3% superior de los solicitantes para proyectos de alta gama.',
                'Plataforma de freelancers con funciones de "workroom" para la gestión de proyectos y colaboración.',
                'Plataforma enfocada en el diseño que se especializa en trabajos creativos a través de concursos y contratación directa.',
                'Plataforma con sede en el Reino Unido, popular en Europa, que combina servicios por hora y licitación de proyectos.',
                'Mercado global de freelancers con sistema de licitación y pagos basados en hitos.',
                'Plataforma enfocada en startups que conecta empresas con talento tecnológico y oportunidades remotas.',
                'Bolsa de trabajo tradicional con listados de trabajo remoto y herramientas de estimación salarial.',
                'Plataforma específica para contratar trabajadores remotos de LATAM con búsqueda de currículums y publicación de empleos.',
                'Agencia de cazatalentos para encontrar talento en el extranjero y "nearshore" con hasta un 70% de ahorro de costos.',
                'Mercado de servicios locales para tareas de mantenimiento, con presencia limitada en América Latina.',
                'Red de freelancers sin comisiones con un enfoque en portafolios y pagos con criptomonedas.',
                'Red de desarrolladores de élite solo por invitación con emparejamiento personalizado y altas tarifas por hora.',
                'Plataforma de pagos transfronterizos que conecta a freelancers con redes bancarias locales en más de 150 países.',
                'Servicio de transferencia de dinero multimoneda con bajas comisiones para pagos internacionales.',
                'Plataforma de trabajo remoto con transparencia salarial y oportunidades en todo el mundo.'
            ],
            'Remote_Jobs': [
                'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí',
                'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí', 'Sí',
                'Sí', 'Sí', 'Sí', 'Sí', 'Limitado', 'Sí', 'Sí', 'N/A', 'N/A', 'Sí'
            ],
            'Target_Audience': [
                'Empresas de EE. UU./Canadá que contratan asistentes virtuales de América Latina', 'Empresas globales que buscan talento de América Latina',
                'PYMES y agencias de EE. UU./Canadá que necesitan personal bilingüe', 'Empresas que desean desarrolladores/profesionales de América Latina',
                'Empresas de EE. UU. que contratan profesionales de marketing, finanzas y tecnología', 'Nómadas digitales y trabajadores remotos a nivel mundial',
                'Buscadores de empleo remoto y empresas de todo el mundo', 'Empresas que priorizan el trabajo remoto y buscadores de empleo a nivel mundial',
                'Trabajadores remotos y empresas globales', 'Profesionales que buscan arreglos de trabajo flexibles',
                'Freelancers y empresas globales', 'Profesionales creativos y compradores de servicios a nivel mundial',
                'Freelancers de América Latina y mercados de habla hispana', 'Profesionales de la tecnología en América Latina',
                'Trabajadores remotos en América Latina', 'Freelancers de élite y clientes con alto presupuesto',
                'Freelancers y empresas que necesitan gestión de proyectos', 'Diseñadores y empresas creativas',
                'Profesionales y empresas europeas', 'Freelancers globales y compradores de proyectos',
                'Startups y empresas de tecnología', 'Buscadores de empleo y empleadores a nivel mundial',
                'Empresas que contratan específicamente trabajadores de LATAM', 'Empresas que buscan talento "nearshore"',
                'Necesidades de servicios locales (LATAM limitado)', 'Profesionales independientes y equipos creativos',
                'Desarrolladores de software de élite y clientes premium', 'Freelancers que reciben pagos internacionales',
                'Usuarios de transferencias de dinero internacionales', 'Buscadores de empleo remoto a nivel mundial'
            ],
            'Qualifications': [
                'Bilingüe (inglés/español), 2+ años de experiencia, nivel de inglés C1, se prefiere título universitario',
                'Habilidades específicas de la industria, dominio del inglés, experiencia laboral relevante',
                'Con educación universitaria, bilingüe, experiencia profesional en áreas específicas',
                'Habilidades técnicas, dominio del inglés, experiencia relevante, portafolio',
                'Calificaciones específicas del rol, dominio del inglés, experiencia profesional',
                'Habilidades digitales, experiencia en trabajo remoto, portafolio/credenciales',
                'Varía según el rol, a menudo requiere experiencia profesional y habilidades',
                'Calificaciones específicas del rol, capacidad para trabajar de forma remota',
                'Varía según el puesto, a menudo se requiere experiencia técnica o profesional',
                'Calificaciones profesionales, se requiere suscripción de pago para el acceso',
                'Basado en habilidades, portafolio, reseñas de trabajos anteriores, varía según el proyecto',
                'Habilidades creativas, portafolio, capacidad para ofrecer servicios de alcance fijo',
                'Fluidez en español/portugués, habilidades profesionales relevantes',
                'Habilidades tecnológicas, se prefiere experiencia en startups, a menudo se requiere ser bilingüe',
                'Experiencia profesional, a menudo calificaciones enfocadas en tecnología',
                'Talento del 3% superior, selección rigurosa, pruebas técnicas, amplia experiencia',
                'Habilidades profesionales, portafolio, capacidad para trabajar en un entorno colaborativo',
                'Portafolio de diseño, habilidades creativas, capacidad de participación en concursos',
                'Habilidades profesionales, se prefiere conocimiento del mercado europeo',
                'Demostración de habilidades, portafolio, capacidad de licitación',
                'Experiencia en startups, habilidades tecnológicas, roles a menudo enfocados en acciones (equity)',
                'Varía según la publicación del trabajo, calificaciones de empleo tradicionales',
                'Residencia en LATAM, habilidades profesionales, a menudo se prefiere ser bilingüe',
                'Calificaciones específicas del rol, experiencia nearshore/offshore',
                'Se requiere presencia local, habilidades de manitas/servicios',
                'Portafolio, 16+ años, identificación válida para verificación',
                'Solo por invitación, habilidades excepcionales, amplia experiencia, desarrolladores de primer nivel',
                'N/A - Plataforma de pago', 'N/A - Plataforma de pago',
                'Calificaciones profesionales, capacidad para trabajar de forma remota'
            ],
            'URL': [
                'virtuallatinos.com', 'remotelatinos.com', 'freelancelatam.com', 'hireinsouth.com',
                'hirelatam.com', 'workingnomads.com', 'remote.co', 'weworkremotely.com',
                'remoteok.com', 'flexjobs.com', 'upwork.com', 'fiverr.com', 'workana.com',
                'getonbrd.com', 'dynamitejobs.com', 'toptal.com', 'guru.com', '99designs.com',
                'peopleperhour.com', 'freelancer.com', 'angel.co', 'indeed.com',
                'prosmarketplace.com', 'somewhere.com', 'taskrabbit.com', 'contra.com',
                'gun.io', 'payoneer.com', 'wise.com', 'remoterocketship.com'
            ],
            'Reliability_Indicators': [
                'Plataforma establecida, pruebas de inglés, testimonios de clientes',
                'Talento verificado, historias de éxito de clientes, precios transparentes',
                'Servicio totalmente gestionado, más de 7 años de operación, más de 80 clientes satisfechos',
                'Proceso de contratación de 21 días, enfoque basado en equipo, reputación establecida',
                'Candidatos preseleccionados, garantía de reemplazo de 90 días, proceso establecido',
                'Listados curados, alcance global, plataforma establecida',
                'Trabajos seleccionados a mano, enfoque en remoto legítimo, reputación establecida',
                'Confiado por grandes marcas, alto volumen de trabajos, plataforma establecida',
                'Actualizaciones en tiempo real, alcance global, alto volumen de tráfico',
                'Modelo de suscripción de pago, verificación de trabajos, establecido desde 2007',
                'Gran base de usuarios, sistema de reseñas, pagos en custodia (escrow), plataforma establecida',
                'Plataforma establecida, sistema de reseñas, protección de pagos',
                'Enfoque regional, establecido en el mercado de LATAM, soporte de pagos locales',
                'Enfocado en tecnología, reputación regional, listados curados',
                'Transparencia salarial, oportunidades verificadas, plataforma emergente',
                'Selección rigurosa, aceptación del 3% superior, reputación premium',
                'Funciones de "workroom", plataforma establecida, herramientas colaborativas',
                'Especialización en diseño, modelo de concurso, reputación establecida',
                'Con sede en el Reino Unido, enfoque europeo, sistema de certificación',
                'Gran plataforma global, pagos por hitos, sistema establecido',
                'Enfoque en startups, reputación tecnológica, respaldo de capital de riesgo',
                'Importante bolsa de trabajo, amplio alcance, marca establecida',
                'Enfoque específico en LATAM, contratación basada en búsqueda',
                'Guías salariales, enfoque especializado, reputación de cazatalentos',
                'Adquisición por parte de IKEA, plataforma importante, enfoque en servicios locales',
                'Modelo sin comisiones, plataforma emergente, enfoque en portafolio',
                'Solo por invitación, reputación de élite, fundada por desarrolladores',
                'Soporte en más de 150 países, plataforma de pago establecida',
                'Bajas comisiones, multimoneda, servicio de transferencia de dinero establecido',
                'Transparencia salarial, alcance global, listados completos'
            ],
            'Potential_Risks': [
                'Competencia por los puestos, barreras por el requisito de inglés',
                'Altos estándares pueden limitar oportunidades, consideraciones de costo para empleadores',
                'Tarifas mensuales, flexibilidad limitada en los términos de contratación',
                'Limitado a regiones específicas, el proceso de 21 días puede ser lento',
                'Período de prueba de 90 días, limitaciones de roles específicos',
                'Competencia del grupo de talentos global',
                'Limitaciones de acceso basadas en suscripción, restricciones geográficas',
                'Alta competencia, tarifa de publicación de $299 para empleadores',
                'Alta competencia, la calidad varía entre los listados',
                'Se requiere suscripción de pago, acceso gratuito limitado',
                'Tarifas de la plataforma, alta competencia, presión sobre las tarifas',
                'Carrera hacia el fondo en precios, alta competencia',
                'Limitaciones regionales, barreras idiomáticas para quienes no hablan español',
                'Limitado a roles de tecnología, enfoque regional',
                'Plataforma más pequeña, volumen de trabajos limitado',
                'Extremadamente competitivo, altos requisitos de habilidades, tarifas caras',
                'Tarifas de la plataforma, competencia',
                'Riesgos del modelo de concurso, enfoque especializado',
                'El enfoque europeo puede limitar las oportunidades globales',
                'Tarifas de la plataforma, competencia en licitaciones, retrasos en los pagos',
                'Volatilidad de las startups, compensación con muchas acciones (equity)',
                'Competencia, volumen de solicitudes, no específico para remoto',
                'Plataforma más pequeña, variedad de trabajos limitada',
                'Plataforma menos establecida, escala limitada',
                'Presencia muy limitada en América Latina',
                'Dependencia del portafolio, plataforma más nueva, suscripción Pro para funciones completas',
                'Acceso solo por invitación, estándares extremadamente altos',
                'Tarifas de transferencia, costos de conversión de moneda',
                'Tarifas de transferencia, limitaciones regulatorias en algunos países',
                'Competencia en la plataforma, calidad variable de los trabajos'
            ],
            'How_to_Get_Paid': [
                'Wise, Payoneer, PayPal, Uphold - pagos quincenales a través de Virtual Latinos',
                'Pago directo a través de la empresa, modelo de ahorro de costos del 80%',
                'Pago mensual único a través de bill.com, ACH o transferencia bancaria',
                'Pago directo, tarifas de mercado, modelo de tarifa mensual',
                'Pago directo al freelancer, varios métodos internacionales',
                'Pago directo del empleador, varía según la publicación del trabajo',
                'Pago directo del empleador, varía según la empresa',
                'Pago directo del empleador, basado en la aplicación',
                'Pago directo del empleador, varía según la empresa',
                'Contacto y pago directo del empleador, modelo de suscripción',
                'Sistema de pago de Upwork, transferencias semanales, PayPal/banco',
                'Sistema de pago de Fiverr, PayPal, transferencia bancaria, retención de 14 días',
                'Sistema de pago de la plataforma, varios métodos locales',
                'Pago directo del empleador, varía según la empresa',
                'Pago directo del empleador, información salarial transparente',
                'Gestionado por la plataforma, altas tarifas por hora ($100-200/h), pagos semanales',
                'Sistema de pago de Guru, SafePay escrow, varios métodos de retiro',
                'Pago de la plataforma después de la finalización del concurso o la entrega del proyecto',
                'Sistema de pago de la plataforma, varias opciones de retiro',
                'Pagos por hitos, PayPal, Skrill, Payoneer, transferencia bancaria',
                'Pago directo del empleador, a menudo acciones (equity) + salario',
                'Pago directo del empleador, varía según la empresa',
                'Pago directo del empleador, la plataforma lo facilita',
                'Pago directo del empleador, gestionado por la plataforma',
                'Sistema de pago de TaskRabbit, pagos semanales, depósito directo',
                'Pago directo, sin comisión, moneda fiduciaria o cripto USDC',
                'Gestionado por la plataforma, típico $100-200/h, tarifas de alta gama',
                'Transferencias internacionales a más de 150 países, multimoneda',
                'Transferencias internacionales, bajas comisiones, tasas del mercado medio',
                'Pago directo del empleador, varía según la empresa'
            ],
            'Application_Requirements': [
                'Prueba de inglés EF SET (nivel C1), ID válida, 2+ años de experiencia, mínimo bachillerato',
                'Evaluación de habilidades, revisión de portafolio, proceso de entrevista',
                'Revisión de solicitud, verificación de habilidades, evaluación de ajuste cultural',
                'Evaluación de habilidades técnicas, revisión de portafolio, entrevista',
                'Selección de solicitudes, verificación de habilidades, verificación de antecedentes',
                'Envío de currículum/portafolio, solicitud directa a los empleadores',
                'Solicitud directa a los trabajos publicados, varía según el empleador',
                'Solicitud a través de la publicación de trabajo, requisitos específicos del empleador',
                'Solicitud directa a las empresas, currículum y portafolio',
                'Suscripción de pago, solicitud a través de la plataforma',
                'Creación de perfil, pruebas de habilidades, portafolio, redacción de propuestas',
                'Configuración de perfil, creación de "gigs", exhibición de portafolio',
                'Creación de perfil, dominio de español/portugués, portafolio',
                'Envío de CV, demostración de habilidades tecnológicas, portafolio',
                'Solicitud a través de la plataforma, revisión de calificaciones',
                'Selección rigurosa: prueba de habilidades, entrevista técnica, revisión de proyecto',
                'Creación de perfil, demostración de habilidades, historial laboral',
                'Envío de portafolio, participación en concursos, habilidades de diseño',
                'Creación de perfil, certificación de habilidades, muestras de trabajo',
                'Configuración de perfil, pruebas de habilidades, licitación en proyectos',
                'Solicitud a través de publicaciones de trabajo, networking en el ecosistema de startups',
                'Carga de currículum, solicitud directa a trabajos',
                'Búsqueda de currículums por parte de los empleadores, tarifa de publicación de trabajo de $79',
                'Revisión de solicitud, evaluación de habilidades, ajuste cultural',
                'Verificación de antecedentes, verificación de habilidades, presencia en el mercado local',
                'Creación de portafolio, verificación de ID válida, 16+ años',
                'Solo por invitación, demostración de habilidades excepcionales, entrevista técnica',
                'N/A - Registro en servicio de pago', 'N/A - Registro en servicio de transferencia de dinero',
                'Envío de currículum, solicitud directa a los trabajos publicados'
            ]
        };

        // Convertir el objeto de arrays en un array de objetos para un manejo más fácil
        let jobs = comprehensiveJobSources.Website.map((website, index) => {
            const entry = {};
            for (const key in comprehensiveJobSources) {
                entry[key] = comprehensiveJobSources[key][index];
            }
            return entry;
        });

        // Función para procesar y asignar etiquetas a una entrada de trabajo
        function processTags(job) {
            const tags = new Set(job.Tags || []);
            const lowercaseWebsite = job.Website.toLowerCase();
            const lowercaseDescription = job.Description.toLowerCase();
            const lowercaseQualifications = (job.Qualifications || '').toLowerCase();
            
            if (lowercaseDescription.includes('américa latina') || lowercaseDescription.includes('latam') || lowercaseWebsite.includes('latinos') || lowercaseWebsite.includes('latam')) {
                tags.add('Foco LATAM');
            }
            if (lowercaseWebsite.includes('freelance') || lowercaseDescription.includes('freelance') || ['upwork', 'fiverr', 'toptal', 'guru', '99designs', 'peopleperhour', 'workana', 'contra'].some(f => lowercaseWebsite.includes(f))) {
                tags.add('Freelance');
            }
            if (lowercaseWebsite.includes('gun.io') || lowercaseWebsite.includes('toptal') || lowercaseWebsite.includes('angel') || lowercaseDescription.includes('tecnología') || lowercaseDescription.includes('desarrollador') || lowercaseWebsite.includes('get on board')) {
                tags.add('Tecnología');
            }
            if (lowercaseWebsite.includes('payoneer') || lowercaseWebsite.includes('wise')) {
                tags.add('Plataforma de Pagos');
            }
            if (lowercaseQualifications.includes('inglés') || lowercaseDescription.includes('inglés') || lowercaseQualifications.includes('bilingüe')) {
                tags.add('Inglés');
            }
            if (lowercaseQualifications.includes('español') || lowercaseDescription.includes('español') || lowercaseQualifications.includes('portugués') || lowercaseQualifications.includes('bilingüe')) {
                tags.add('Español');
            }
            job.Tags = Array.from(tags);
        }

        // Añadir etiquetas a cada entrada de trabajo
        jobs.forEach(processTags);

        // Añadir insignias de recomendado a las fuentes principales
        jobs[0].isRecommended = true; // Virtual Latinos
        jobs[1].isRecommended = true; // Remote Latinos
        jobs[10].isRecommended = true; // Upwork


        // Referencias a elementos del DOM
        const searchBar = document.getElementById('search-bar');
        const jobListingsContainer = document.getElementById('job-listings-container');
        const gridViewBtn = document.getElementById('grid-view-btn');
        const listViewBtn = document.getElementById('list-view-btn');
        const tagContainer = document.getElementById('tag-container');
        const themeToggleBtn = document.getElementById('theme-toggle');
        const addModal = document.getElementById('add-modal');
        const addNewBtn = document.getElementById('add-new-btn');
        const modalCloseBtn = document.getElementById('modal-close-btn');
        const loginForm = document.getElementById('login-form');
        const dataEntryContainer = document.getElementById('data-entry-container');
        const modalTitle = document.getElementById('modal-title');
        const loginMessage = document.getElementById('login-message');
        const addDataForm = document.getElementById('add-data-form');
        const csvUploadInput = document.getElementById('csv-upload');
        const uploadCsvBtn = document.getElementById('upload-csv-btn');
        const existingTagsContainer = document.getElementById('existing-tags-container');
        const selectedTagsContainer = document.getElementById('selected-tags-container');

        let currentView = 'grid'; // 'grid' o 'list'
        let activeFilter = 'Todos';
        let modalSelectedTags = new Set();

        // Función para crear un elemento HTML con clases y contenido
        function createElement(tag, classes = [], content = '') {
            const el = document.createElement(tag);
            el.classList.add(...classes);
            if (typeof content === 'string') {
                el.innerHTML = content;
            } else if (content) {
                el.appendChild(content);
            }
            return el;
        }

        // Función para renderizar los listados de trabajos
        function renderJobs(filteredJobs) {
            jobListingsContainer.innerHTML = ''; // Limpiar contenido existente
            jobListingsContainer.classList.remove('grid-view', 'list-view');
            jobListingsContainer.classList.add(`${currentView}-view`);
            
            if (currentView === 'grid') {
                jobListingsContainer.classList.add('grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3');
            } else {
                jobListingsContainer.classList.remove('grid-cols-1', 'md:grid-cols-2', 'lg:grid-cols-3');
            }

            if (filteredJobs.length === 0) {
                const noResults = createElement('p', ['text-center', 'text-gray-500', 'dark:text-gray-400', 'text-xl', 'col-span-full', 'py-10'], 'No se encontraron resultados.');
                jobListingsContainer.appendChild(noResults);
                return;
            }

            filteredJobs.forEach(job => {
                const card = createElement('div', ['job-card', 'rounded-xl', 'shadow-md', 'p-6', 'flex', 'flex-col', 'border', 'transition-all', 'duration-300']);

                // --- Contenido de la Vista de Cuadrícula ---
                const gridContent = createElement('div', ['job-card-grid-content', 'space-y-4']);
                const headerContainer = createElement('div', ['flex', 'items-center', 'justify-between']);
                const titleGroup = createElement('div', ['flex', 'items-center', 'min-w-0']);
                const icon = createElement('div', ['flex-shrink-0'], `<i data-lucide="building-2" class="w-6 h-6 text-primary mr-3"></i>`);
                const titleContent = createElement('div', ['min-w-0']);
                const gridTitle = createElement('h2', ['text-xl', 'font-bold', 'dark:text-white', 'truncate'], job.Website);
                
                titleContent.appendChild(gridTitle);
                titleGroup.appendChild(icon);
                titleGroup.appendChild(titleContent);
                headerContainer.appendChild(titleGroup);

                if (job.isRecommended) {
                    const badge = createElement('img');
                    badge.src = 'https://bucket.mlcdn.com/a/3336/3336910/images/596d184d246afd7cd39f546aa38386ee16ef4e5f.png';
                    badge.alt = 'Fuente Recomendada';
                    badge.className = 'w-10 h-10 object-contain ml-3 flex-shrink-0';
                    headerContainer.appendChild(badge);
                }
                
                const description = createElement('p', ['text-gray-600', 'dark:text-gray-300', 'text-sm'], job.Description);
                const tagsContainer = createElement('div', ['flex', 'flex-wrap', 'gap-2']);
                (job.Tags || []).forEach(tag => {
                    const tagEl = createElement('span', ['px-2', 'py-1', 'text-xs', 'font-semibold', 'bg-gray-200', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300', 'rounded-full'], tag);
                    tagsContainer.appendChild(tagEl);
                });
                gridContent.appendChild(headerContainer);
                gridContent.appendChild(description);
                gridContent.appendChild(tagsContainer);

                // --- Contenido de la Vista de Lista ---
                const listContent = createElement('div', ['job-card-list-content', 'list-view-card', 'md:items-center', 'space-y-4', 'md:space-y-0', 'md:space-x-4']);
                
                const listTitleContainer = createElement('div', ['flex', 'items-center', 'justify-between', 'w-full']);
                const listTitleIconGroup = createElement('div', ['flex', 'items-center', 'min-w-0']);

                listTitleIconGroup.innerHTML = `<i data-lucide="building-2" class="w-5 h-5 text-primary mr-3 flex-shrink-0"></i>`;
                const listTitleGroup = createElement('div', ['min-w-0']);
                const listTitle = createElement('h3', ['text-lg', 'font-bold', 'dark:text-white', 'truncate'], job.Website);
                const listUrl = createElement('a', ['text-sm', 'text-gray-500', 'dark:text-gray-400', 'hover:underline', 'truncate', 'block'], job.URL);
                listUrl.href = `https://${job.URL}`;
                listUrl.target = "_blank";
                listTitleGroup.appendChild(listTitle);
                listTitleGroup.appendChild(listUrl);
                listTitleIconGroup.appendChild(listTitleGroup);
                listTitleContainer.appendChild(listTitleIconGroup);

                if (job.isRecommended) {
                    const badge = createElement('img');
                    badge.src = 'https://bucket.mlcdn.com/a/3336/3336910/images/596d184d246afd7cd39f546aa38386ee16ef4e5f.png';
                    badge.alt = 'Fuente Recomendada';
                    badge.className = 'w-10 h-10 object-contain ml-3 flex-shrink-0';
                    listTitleContainer.appendChild(badge);
                }
                
                const listDescription = createElement('p', ['text-sm', 'text-gray-600', 'dark:text-gray-300'], job.Description);
                const reliabilityTag = createElement('p', ['text-xs', 'md:text-right', 'text-gray-500', 'dark:text-gray-400', 'truncate'], job.Reliability_Indicators.split(',')[0].trim());
                
                listContent.appendChild(listTitleContainer);
                listContent.appendChild(listDescription);
                listContent.appendChild(reliabilityTag);
                
                // --- Detalles Desplegables ---
                const detailsContainer = createElement('div', ['collapsible-content', 'mt-4', 'pt-4', 'border-t']);
                const details = [
                    { title: 'Público Objetivo', content: job.Target_Audience },
                    { title: 'Requisitos', content: job.Qualifications },
                    { title: 'Indicadores de Confianza', content: job.Reliability_Indicators },
                    { title: 'Riesgos Potenciales', content: job.Potential_Risks },
                    { title: 'Cómo Recibir Pagos', content: job.How_to_Get_Paid },
                    { title: 'Requisitos de Aplicación', content: job.Application_Requirements },
                ];
                
                details.forEach(detail => {
                    if(detail.content && detail.content.trim() !== '' && detail.content.trim().toLowerCase() !== 'n/a'){
                        const detailEl = createElement('div', ['mb-3']);
                        const detailTitle = createElement('h4', ['text-sm', 'font-bold', 'dark:text-white'], detail.title);
                        const detailContent = createElement('p', ['text-sm', 'text-gray-600', 'dark:text-gray-300'], detail.content);
                        detailEl.appendChild(detailTitle);
                        detailEl.appendChild(detailContent);
                        detailsContainer.appendChild(detailEl);
                    }
                });

                const urlContainer = createElement('div', ['mt-4', 'flex', 'items-center', 'justify-between', 'bg-gray-100', 'dark:bg-gray-800', 'p-2', 'rounded-md']);
                const urlText = createElement('span', ['text-sm', 'text-gray-500', 'dark:text-gray-400', 'truncate', 'mr-2', 'font-mono'], `https://${job.URL}`);
                const copyButton = createElement('button', ['p-1.5', 'rounded', 'hover:bg-gray-200', 'dark:hover:bg-gray-600', 'transition-colors']);
                copyButton.innerHTML = '<i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>';
                
                copyButton.onclick = (e) => {
                    e.stopPropagation();
                    navigator.clipboard.writeText(`https://${job.URL}`).then(() => {
                        copyButton.innerHTML = '<i data-lucide="check" class="w-4 h-4 text-green-500"></i>';
                        setTimeout(() => {
                            copyButton.innerHTML = '<i data-lucide="copy" class="w-4 h-4 text-gray-500 dark:text-gray-400"></i>';
                            lucide.createIcons();
                        }, 2000);
                    });
                };
                urlContainer.appendChild(urlText);
                urlContainer.appendChild(copyButton);
                detailsContainer.appendChild(urlContainer);
                
                const websiteButton = createElement('a', ['mt-4', 'w-full', 'inline-flex', 'items-center', 'justify-center', 'px-4', 'py-2', 'text-sm', 'font-medium', 'rounded-full', 'text-white', 'bg-primary', 'hover:bg-primary/80', 'transition-colors', 'duration-300', 'shadow-md'], 'Visitar Sitio Web');
                websiteButton.href = `https://${job.URL}`;
                websiteButton.target = "_blank";
                websiteButton.onclick = (e) => e.stopPropagation();
                
                card.appendChild(gridContent);
                card.appendChild(listContent);
                card.appendChild(detailsContainer);
                
                const footer = createElement('div', ['mt-auto', 'pt-4']);
                footer.appendChild(websiteButton);
                card.appendChild(footer);

                card.addEventListener('click', () => {
                    detailsContainer.classList.toggle('expanded');
                });
                
                jobListingsContainer.appendChild(card);
            });
            lucide.createIcons();
        }

        function filterJobs() {
            const query = searchBar.value.toLowerCase();
            const filtered = jobs.filter(job => {
                const matchesSearch = job.Website.toLowerCase().includes(query) ||
                                      job.Description.toLowerCase().includes(query) ||
                                      ((job.Tags || []).some(tag => tag.toLowerCase().includes(query)));
                const matchesFilter = activeFilter === 'Todos' || ((job.Tags || []).includes(activeFilter));
                return matchesSearch && matchesFilter;
            });
            renderJobs(filtered);
        }

        // Actualizar los botones de filtro de etiquetas principales
        function updateMainTagFilters() {
            const allTags = [...new Set(jobs.flatMap(job => job.Tags || []))].sort();
            tagContainer.innerHTML = ''; // Limpiar etiquetas existentes

            const allButton = createElement('button', ['tag-filter', 'px-4', 'py-2', 'text-sm', 'font-semibold', 'rounded-full', 'border', 'border-gray-300', 'dark:border-gray-600'], 'Todos');
            allButton.dataset.filter = 'Todos';
            tagContainer.appendChild(allButton);

            allTags.forEach(tag => {
                const tagButton = createElement('button', ['tag-filter', 'px-4', 'py-2', 'text-sm', 'font-semibold', 'rounded-full', 'border', 'border-gray-300', 'dark:border-gray-600', 'bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300', 'hover:bg-primary', 'hover:text-white', 'transition-all', 'duration-300'], tag);
                tagButton.dataset.filter = tag;
                tagContainer.appendChild(tagButton);
            });

            // Re-aplicar estilo activo
            const currentActiveButton = tagContainer.querySelector(`[data-filter="${activeFilter}"]`) || allButton;
            currentActiveButton.classList.add('bg-primary', 'text-white');
            currentActiveButton.classList.remove('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
        }

        function populateModalTags() {
            const allTags = [...new Set(jobs.flatMap(job => job.Tags || []))].sort();
            existingTagsContainer.innerHTML = '';
            allTags.forEach(tag => {
                const tagButton = createElement('button', ['px-2', 'py-1', 'text-xs', 'font-semibold', 'bg-gray-200', 'dark:bg-gray-600', 'text-gray-700', 'dark:text-gray-300', 'rounded-full', 'hover:bg-primary', 'hover:text-white', 'transition-colors'], tag);
                tagButton.type = 'button'; // Prevenir envío de formulario
                tagButton.addEventListener('click', () => {
                    toggleModalTag(tag);
                });
                existingTagsContainer.appendChild(tagButton);
            });
        }

        function toggleModalTag(tag) {
            if (modalSelectedTags.has(tag)) {
                modalSelectedTags.delete(tag);
            } else {
                modalSelectedTags.add(tag);
            }
            renderModalSelectedTags();
        }

        function renderModalSelectedTags() {
            selectedTagsContainer.innerHTML = '';
            modalSelectedTags.forEach(tag => {
                const tagEl = createElement('span', ['px-2', 'py-1', 'text-xs', 'font-semibold', 'bg-primary', 'text-white', 'rounded-full', 'flex', 'items-center', 'gap-1'], tag);
                const removeBtn = createElement('button', [], '&times;');
                removeBtn.type = 'button';
                removeBtn.onclick = () => toggleModalTag(tag);
                tagEl.appendChild(removeBtn);
                selectedTagsContainer.appendChild(tagEl);
            });
        }

        // Configuración de los Event Listeners
        function setupEventListeners() {
            searchBar.addEventListener('input', filterJobs);

            gridViewBtn.addEventListener('click', () => {
                currentView = 'grid';
                gridViewBtn.classList.add('bg-primary', 'text-white');
                gridViewBtn.classList.remove('bg-gray-300', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300');
                listViewBtn.classList.remove('bg-primary', 'text-white');
                listViewBtn.classList.add('bg-gray-300', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300');
                filterJobs();
            });

            listViewBtn.addEventListener('click', () => {
                currentView = 'list';
                listViewBtn.classList.add('bg-primary', 'text-white');
                listViewBtn.classList.remove('bg-gray-300', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300');
                gridViewBtn.classList.remove('bg-primary', 'text-white');
                gridViewBtn.classList.add('bg-gray-300', 'dark:bg-gray-600', 'text-gray-600', 'dark:text-gray-300');
                filterJobs();
            });

            tagContainer.addEventListener('click', (e) => {
                if (e.target.classList.contains('tag-filter')) {
                    const allTagFilters = tagContainer.querySelectorAll('.tag-filter');
                    allTagFilters.forEach(t => {
                        t.classList.remove('bg-primary', 'text-white');
                        t.classList.add('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    });
                    e.target.classList.add('bg-primary', 'text-white');
                    e.target.classList.remove('bg-white', 'dark:bg-gray-700', 'text-gray-700', 'dark:text-gray-300');
                    activeFilter = e.target.dataset.filter;
                    filterJobs();
                }
            });

            themeToggleBtn.addEventListener('click', () => {
                document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', document.documentElement.classList.contains('dark') ? 'dark' : 'light');
            });

            addNewBtn.addEventListener('click', () => {
                populateModalTags();
                addModal.classList.remove('hidden');
            });

            modalCloseBtn.addEventListener('click', () => {
                addModal.classList.add('hidden');
                loginForm.classList.remove('hidden');
                dataEntryContainer.classList.add('hidden');
                modalTitle.textContent = "Acceso de Administrador";
                loginMessage.textContent = "";
                loginForm.reset();
                addDataForm.reset();
                modalSelectedTags.clear();
                renderModalSelectedTags();
            });

            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;
                if (username === 'Bebell' && password === 'Bebell/25') {
                    loginMessage.textContent = "¡Inicio de sesión exitoso!";
                    loginMessage.className = 'text-center text-sm font-medium text-green-500';
                    setTimeout(() => {
                      loginForm.classList.add('hidden');
                      dataEntryContainer.classList.remove('hidden');
                      modalTitle.textContent = "Añadir Nueva Entrada";
                    }, 500);
                } else {
                    loginMessage.textContent = "Nombre de usuario o contraseña inválidos.";
                    loginMessage.className = 'text-center text-sm font-medium text-red-500';
                }
            });

            addDataForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const inputTags = document.getElementById('new-tags').value.split(',').map(t => t.trim()).filter(Boolean);
                const finalTags = new Set([...modalSelectedTags, ...inputTags]);

                const newEntry = {
                    'Website': document.getElementById('website').value,
                    'Description': document.getElementById('description').value,
                    'Remote_Jobs': document.getElementById('remote-jobs').value,
                    'Target_Audience': document.getElementById('target-audience').value,
                    'Qualifications': document.getElementById('qualifications').value,
                    'URL': document.getElementById('url').value.replace(/^(https?:\/\/)/, ''),
                    'Reliability_Indicators': document.getElementById('reliability-indicators').value,
                    'Potential_Risks': document.getElementById('potential-risks').value,
                    'How_to_Get_Paid': document.getElementById('how-to-get-paid').value,
                    'Application_Requirements': document.getElementById('application-requirements').value,
                    'isRecommended': document.getElementById('is-recommended').checked,
                    'Tags': Array.from(finalTags)
                };
                
                processTags(newEntry); // Ejecutar etiquetado automático también
                jobs.push(newEntry);
                updateMainTagFilters(); // Actualizar la lista de filtros principales
                filterJobs();
                modalCloseBtn.click();
            });

            uploadCsvBtn.addEventListener('click', () => {
                const file = csvUploadInput.files[0];
                if (!file) {
                    alert("Por favor, selecciona un archivo CSV para subir.");
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(event) {
                    const csvData = event.target.result;
                    const lines = csvData.split('\n');
                    const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
                    for (let i = 1; i < lines.length; i++) {
                        if (lines[i].trim() === '') continue;
                        const values = lines[i].match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g).map(v => v.trim().replace(/"/g, ''));
                        const newEntry = {};
                        headers.forEach((h, index) => { newEntry[h.replace(/\s/g, '_')] = values[index] || ''; });
                        processTags(newEntry);
                        jobs.push(newEntry);
                    }
                    updateMainTagFilters();
                    filterJobs();
                    modalCloseBtn.click();
                };
                reader.readAsText(file);
            });
        }

        // Configuración inicial
        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
            
            updateMainTagFilters();
            filterJobs();
            setupEventListeners();
            lucide.createIcons();
        });
    </script>
</body>
</html>
